<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>多级页面缓存 | Fantastic-admin 官网</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="./favicon.ico">
    <keywords content="fantastic-admin,后台系统,管理后台,后台模版,vue后台,vue-admin,vue-element-admin,vue-admin-template"></keywords>
    <script>var _hmt = _hmt || [];
		(function() {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?ba0ee7b31f404b7dc10bfcd8bdc7183d";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
		})();</script>
    <meta name="description" content="一款开箱即用的 Vue 中后台管理系统框架">
    
    <link rel="preload" href="/fantastic-admin/assets/css/0.styles.634c1f1d.css" as="style"><link rel="preload" href="/fantastic-admin/assets/js/app.d0b9bc17.js" as="script"><link rel="preload" href="/fantastic-admin/assets/js/2.1e4ce21f.js" as="script"><link rel="preload" href="/fantastic-admin/assets/js/39.444b4408.js" as="script"><link rel="prefetch" href="/fantastic-admin/assets/js/10.0d6faf15.js"><link rel="prefetch" href="/fantastic-admin/assets/js/11.dbced3b0.js"><link rel="prefetch" href="/fantastic-admin/assets/js/12.8b708330.js"><link rel="prefetch" href="/fantastic-admin/assets/js/13.589f873e.js"><link rel="prefetch" href="/fantastic-admin/assets/js/14.b1e8f789.js"><link rel="prefetch" href="/fantastic-admin/assets/js/15.a3560371.js"><link rel="prefetch" href="/fantastic-admin/assets/js/16.788991e9.js"><link rel="prefetch" href="/fantastic-admin/assets/js/17.a630eaca.js"><link rel="prefetch" href="/fantastic-admin/assets/js/18.2b6893af.js"><link rel="prefetch" href="/fantastic-admin/assets/js/19.42f6eca6.js"><link rel="prefetch" href="/fantastic-admin/assets/js/20.de0fca29.js"><link rel="prefetch" href="/fantastic-admin/assets/js/21.915550b7.js"><link rel="prefetch" href="/fantastic-admin/assets/js/22.0769c30f.js"><link rel="prefetch" href="/fantastic-admin/assets/js/23.05e778b3.js"><link rel="prefetch" href="/fantastic-admin/assets/js/24.4b260296.js"><link rel="prefetch" href="/fantastic-admin/assets/js/25.c1c45d0e.js"><link rel="prefetch" href="/fantastic-admin/assets/js/26.82481a41.js"><link rel="prefetch" href="/fantastic-admin/assets/js/27.e63f6ba6.js"><link rel="prefetch" href="/fantastic-admin/assets/js/28.4b3a7bf8.js"><link rel="prefetch" href="/fantastic-admin/assets/js/29.9a9b705a.js"><link rel="prefetch" href="/fantastic-admin/assets/js/3.12ebf88b.js"><link rel="prefetch" href="/fantastic-admin/assets/js/30.13161cf5.js"><link rel="prefetch" href="/fantastic-admin/assets/js/31.18a21efe.js"><link rel="prefetch" href="/fantastic-admin/assets/js/32.d49b622e.js"><link rel="prefetch" href="/fantastic-admin/assets/js/33.5dd9c5d6.js"><link rel="prefetch" href="/fantastic-admin/assets/js/34.429b9d15.js"><link rel="prefetch" href="/fantastic-admin/assets/js/35.babbf809.js"><link rel="prefetch" href="/fantastic-admin/assets/js/36.026b57ad.js"><link rel="prefetch" href="/fantastic-admin/assets/js/37.bf972ecc.js"><link rel="prefetch" href="/fantastic-admin/assets/js/38.3e7d8129.js"><link rel="prefetch" href="/fantastic-admin/assets/js/4.50945f3b.js"><link rel="prefetch" href="/fantastic-admin/assets/js/40.932c9bbc.js"><link rel="prefetch" href="/fantastic-admin/assets/js/41.2f7a16a3.js"><link rel="prefetch" href="/fantastic-admin/assets/js/42.35cae4e8.js"><link rel="prefetch" href="/fantastic-admin/assets/js/43.55bc0be2.js"><link rel="prefetch" href="/fantastic-admin/assets/js/44.7ff851b7.js"><link rel="prefetch" href="/fantastic-admin/assets/js/45.de51e04a.js"><link rel="prefetch" href="/fantastic-admin/assets/js/46.8b9e5e1d.js"><link rel="prefetch" href="/fantastic-admin/assets/js/47.58bcdf51.js"><link rel="prefetch" href="/fantastic-admin/assets/js/48.3e3c7138.js"><link rel="prefetch" href="/fantastic-admin/assets/js/49.2f2a136f.js"><link rel="prefetch" href="/fantastic-admin/assets/js/5.2782d28b.js"><link rel="prefetch" href="/fantastic-admin/assets/js/50.6064141a.js"><link rel="prefetch" href="/fantastic-admin/assets/js/51.97af4548.js"><link rel="prefetch" href="/fantastic-admin/assets/js/52.bcc03545.js"><link rel="prefetch" href="/fantastic-admin/assets/js/53.b226fbf8.js"><link rel="prefetch" href="/fantastic-admin/assets/js/54.c552df92.js"><link rel="prefetch" href="/fantastic-admin/assets/js/55.96ad1a86.js"><link rel="prefetch" href="/fantastic-admin/assets/js/56.165f05f7.js"><link rel="prefetch" href="/fantastic-admin/assets/js/6.73c063ed.js"><link rel="prefetch" href="/fantastic-admin/assets/js/7.1c09d42a.js"><link rel="prefetch" href="/fantastic-admin/assets/js/8.1e1abb58.js"><link rel="prefetch" href="/fantastic-admin/assets/js/9.be7df256.js">
    <link rel="stylesheet" href="/fantastic-admin/assets/css/0.styles.634c1f1d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fantastic-admin/" class="home-link router-link-active"><img src="/fantastic-admin/logo.png" alt="Fantastic-admin 官网" class="logo"> <span class="site-name can-hide">Fantastic-admin 官网</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fantastic-admin/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/fantastic-admin/components/" class="nav-link">
  组件
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="演示地址" class="dropdown-title"><span class="title">演示地址</span> <span class="arrow down"></span></button> <button type="button" aria-label="演示地址" class="mobile-dropdown-title"><span class="title">演示地址</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://hooray.gitee.io/fantastic-admin/basic" target="_blank" rel="noopener noreferrer" class="nav-link external">
  基础版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://hooray.gitee.io/fantastic-admin/pro" target="_blank" rel="noopener noreferrer" class="nav-link external">
  专业版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://space.bilibili.com/3079082/channel/detail?cid=156985" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/fantastic-admin/buy.html" class="nav-link">
  购买专业版
</a></div><div class="nav-item"><a href="https://gitee.com/hooray/fantastic-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/hooray/fantastic-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fantastic-admin/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/fantastic-admin/components/" class="nav-link">
  组件
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="演示地址" class="dropdown-title"><span class="title">演示地址</span> <span class="arrow down"></span></button> <button type="button" aria-label="演示地址" class="mobile-dropdown-title"><span class="title">演示地址</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://hooray.gitee.io/fantastic-admin/basic" target="_blank" rel="noopener noreferrer" class="nav-link external">
  基础版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://hooray.gitee.io/fantastic-admin/pro" target="_blank" rel="noopener noreferrer" class="nav-link external">
  专业版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://space.bilibili.com/3079082/channel/detail?cid=156985" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/fantastic-admin/buy.html" class="nav-link">
  购买专业版
</a></div><div class="nav-item"><a href="https://gitee.com/hooray/fantastic-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/hooray/fantastic-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/fantastic-admin/guide/" aria-current="page" class="sidebar-link">文档说明</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fantastic-admin/guide/start.html" class="sidebar-link">开始</a></li><li><a href="/fantastic-admin/guide/coding-standard.html" class="sidebar-link">代码规范</a></li><li><a href="/fantastic-admin/guide/configure.html" class="sidebar-link">配置</a></li><li><a href="/fantastic-admin/guide/layout.html" class="sidebar-link">布局</a></li><li><a href="/fantastic-admin/guide/theme.html" class="sidebar-link">主题</a></li><li><a href="/fantastic-admin/guide/global-resources.html" class="sidebar-link">全局资源</a></li><li><a href="/fantastic-admin/guide/axios.html" class="sidebar-link">和服务端交互</a></li><li><a href="/fantastic-admin/guide/component.html" class="sidebar-link">组件</a></li><li><a href="/fantastic-admin/guide/vuex.html" class="sidebar-link">Vuex</a></li><li><a href="/fantastic-admin/guide/router.html" class="sidebar-link">路由</a></li><li><a href="/fantastic-admin/guide/permission.html" class="sidebar-link">权限验证</a></li><li><a href="/fantastic-admin/guide/tabbar.html" class="sidebar-link">标签栏（专业版）</a></li><li><a href="/fantastic-admin/guide/keep-alive.html" class="sidebar-link">二级页面缓存</a></li><li><a href="/fantastic-admin/guide/keep-alive-neste.html" aria-current="page" class="active sidebar-link">多级页面缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fantastic-admin/guide/keep-alive-neste.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/fantastic-admin/guide/font.html" class="sidebar-link">自定义字体（专业版）</a></li><li><a href="/fantastic-admin/guide/i18n.html" class="sidebar-link">国际化（专业版）</a></li><li><a href="/fantastic-admin/guide/storage.html" class="sidebar-link">私有 Storage 数据（专业版）</a></li><li><a href="/fantastic-admin/guide/library.html" class="sidebar-link">第三方库</a></li><li><a href="/fantastic-admin/guide/cdn.html" class="sidebar-link">CDN 支持</a></li><li><a href="/fantastic-admin/guide/gzip.html" class="sidebar-link">gzip 支持</a></li><li><a href="/fantastic-admin/guide/mock.html" class="sidebar-link">Mock 与联调</a></li><li><a href="/fantastic-admin/guide/build.html" class="sidebar-link">构建</a></li><li><a href="/fantastic-admin/guide/git.html" class="sidebar-link">Git 钩子（专业版）</a></li><li><a href="/fantastic-admin/guide/bug.html" class="sidebar-link">错误日志（专业版）</a></li><li><a href="/fantastic-admin/guide/plop.html" class="sidebar-link">快速生成文件（专业版）</a></li><li><a href="/fantastic-admin/guide/module.html" class="sidebar-link">标准模块（专业版）</a></li><li><a href="/fantastic-admin/guide/position-fixed.html" class="sidebar-link">高级 position:fixed（专业版）</a></li><li><a href="/fantastic-admin/guide/upgrade.html" class="sidebar-link">版本升级</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="多级页面缓存"><a href="#多级页面缓存" class="header-anchor">#</a> 多级页面缓存</h1> <p>因为路由直接影响侧边栏导航菜单，所以为了实现多级侧边栏导航菜单，就需要将路由配置成多级嵌套的形式。一旦超过两级，达到三级甚至更多级，就需要增加一个空布局页面（Empty.vue）用来给 component 使用。此时就出现了一个问题，因为 keep-alive 是在 Layout 上处理的，所以超过两级以上的路由需要做页面缓存会出现各种各样奇怪的 bug 。</p> <p>在思考并解决这个问题之前，我们先来看下页面大致结构：</p> <div class="language- extra-class"><pre class="language-text"><code>+------------------------------+
| Layout                       |
|  +------------------------+  |
|  | Empty                  |  |
|  |  +------------------+  |  |
|  |  | Page             |  |  |
|  |  +------------------+  |  |
|  +------------------------+  |
+------------------------------+
</code></pre></div><p>首先 keep-alive 是在 Layout 上进行处理，如果不缓存 Empty ，则 Empty 下面的页面将无法被缓存，如果缓存 Empty ，又会导致 Empty 里面的所有页面都被缓存，无法按需清除，相信接触过的同学肯定感同身受其中的大坑。</p> <p><img src="/fantastic-admin/keep-alive1.gif" alt="多级路由导致所有页面被缓存"></p> <p>就如上面这张图一样，即便将 tab 标签页关闭后，再次打开缓存还是存在。</p> <p>框架的解决思路很简单，既然缓存二级路由是没问题，而超过二级的中间层级页面本身也是没太大意义的，那就将路由直接处理成二级，这样页面显示也就是二级的结构。</p> <div class="language- extra-class"><pre class="language-text"><code>+------------------------------+                +------------------------------+
| Layout                       |                | Layout.vue                   |
|  +------------------------+  |                |  +------------------------+  |
|  | Empty                  |  |  +----------&gt;  |  | Page                   |  |
|  |  +------------------+  |  |                |  |                        |  |
|  |  | Page             |  |  |                |  |                        |  |
|  |  +------------------+  |  |                |  |                        |  |
|  +------------------------+  |                |  +------------------------+  |
+------------------------------+                +------------------------------+
</code></pre></div><p>这里路由配置还是保持多级嵌套的形式，而这个配置并非最终注册使用的路由，仅仅是提供侧边栏导航菜单使用，同时会再生成一份用于动态注册路由的数据，图例如果没看明白的话，可以看下面两组数据。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 原始数据（用于侧边栏导航菜单）</span>
<span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'用户管理'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'clients'</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token string">'客户管理'</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            children<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    path<span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
                    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                        title<span class="token operator">:</span> <span class="token string">'客户列表'</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    path<span class="token operator">:</span> <span class="token string">'detail'</span><span class="token punctuation">,</span>
                    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                        title<span class="token operator">:</span> <span class="token string">'客户详情'</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 处理后数据（用于动态注册路由，框架会自动处理）</span>
<span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'用户管理'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'clients/list'</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token string">'客户列表'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'clients/detail'</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token string">'客户详情'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过一个递归函数就可以处理好路由的数据，但这还不够，因为还需要处理面包屑导航。</p> <p>原有的面包屑导航是通过 <code>$route.matched</code> 可以获取到嵌套路由每一层级的信息，而当路由被处理成两级后，也就无法通过 <code>$route.matched</code> 进行显示了，所以在处理路由数据的同时，也需要处理面包屑导航的信息。大致最终会处理成这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'用户管理'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'clients/list'</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token string">'客户列表'</span><span class="token punctuation">,</span>
                breadCrumb<span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'用户管理'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'clients'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'客户管理'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'客户列表'</span> <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'clients/detail'</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token string">'客户详情'</span><span class="token punctuation">,</span>
                breadCrumb<span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'用户管理'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'clients'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'客户管理'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'detail'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'客户详情'</span> <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样一来，通过 <code>$route.meta.breadcrumb</code> 就可以获取任意某个路由的完整面包屑导航信息了。最终效果如下：</p> <p><img src="/fantastic-admin/keep-alive2.gif" alt=""></p> <p>通过图片可以看到，这种方案也还是有一定的限制，就是路由被处理成二级后，多级嵌套关系不存在了，也就是不能在 Empty 里写任何代码，因为都会被忽略掉，只保留顶级和最深层的底级两个路由。</p> <p>当然通过实际情况考虑，这种限制并没有大问题，因为在后台系统里，本身模块相对独立，即便侧边栏导航菜单是嵌套层级关系的，在右侧内容展示区域，几乎都是独立模块展示，无需嵌套。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>以上是介绍了框架对多级嵌套路由如何做缓存做了一个详尽的解释，在使用上其实并不需要关系内部逻辑，通过修改 settings.js 文件里的 <code>enableFlatRoutes: true</code> 就可以开启扁平化路由的功能，三级或超过三级的路由都会处理成二级路由。</p> <p>当然不开启这个设置也是可以的，即路由配置的多少嵌套层级，页面也是对应的嵌套层级。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fantastic-admin/guide/keep-alive.html" class="prev">
        二级页面缓存
      </a></span> <span class="next"><a href="/fantastic-admin/guide/font.html">
        自定义字体（专业版）
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/fantastic-admin/assets/js/app.d0b9bc17.js" defer></script><script src="/fantastic-admin/assets/js/2.1e4ce21f.js" defer></script><script src="/fantastic-admin/assets/js/39.444b4408.js" defer></script>
  </body>
</html>
